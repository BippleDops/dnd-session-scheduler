(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3634,e=>{"use strict";var s=e.i(5111);function a({text:e="Loading..."}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-end gap-3",children:[(0,s.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"}),(0,s.jsx)("div",{className:"candle-flame"}),(0,s.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"})]}),(0,s.jsx)("p",{className:"text-[var(--gold)] font-[var(--font-heading)] text-lg animate-pulse",children:e})]})}e.s(["default",()=>a])},9064,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({children:e,className:t,pinned:l=!1,title:n}){return(0,s.jsxs)("div",{className:(0,a.cn)(l?"quest-card":"parchment","p-5 mb-4",t),children:[n&&(0,s.jsx)("h2",{className:"font-[var(--font-heading)] text-lg text-[var(--gold)] mb-3",children:n}),e]})}e.s(["default",()=>t])},54520,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({variant:e="default",href:t,className:l,children:n,...r}){let d=(0,a.cn)("wood-btn","primary"===e&&"wood-btn-primary","secondary"===e&&"opacity-70 hover:opacity-100","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",l);return t?(0,s.jsx)("a",{href:t,className:d,children:n}):(0,s.jsx)("button",{className:d,...r,children:n})}e.s(["default",()=>t])},45817,e=>{"use strict";var s=e.i(5111),a=e.i(55703),t=e.i(84249),l=e.i(8779),n=e.i(9064),r=e.i(54520),d=e.i(3634);function i(){let{isLoggedIn:e,user:i}=(0,t.useAuth)(),[c,o]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[u,h]=(0,a.useState)(!0),[j,g]=(0,a.useState)(!1),[f,p]=(0,a.useState)({toPlayerId:"",subject:"",body:""}),[b,v]=(0,a.useState)(null);(0,a.useEffect)(()=>{e&&Promise.all([(0,l.getMyMessages)(),(0,l.getAdminPlayers)()]).then(([e,s])=>{o(e),x(s)}).finally(()=>h(!1))},[e]);let N=async e=>{e.preventDefault(),await (0,l.sendMessage)(f),g(!1),p({toPlayerId:"",subject:"",body:""}),(0,l.getMyMessages)().then(o)},y=async e=>{v(e),e.read||(await (0,l.markMessageRead)(e.message_id),o(s=>s.map(s=>s.message_id===e.message_id?{...s,read:1}:s)))};if(!e)return(0,s.jsx)(n.default,{title:"Sign In Required",children:(0,s.jsx)("p",{children:"Please sign in to view messages."})});if(u)return(0,s.jsx)(d.default,{text:"Loading messages..."});let w=c.filter(e=>!e.read&&e.to_name===i?.name).length;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("h1",{className:"font-[var(--font-heading)] text-2xl text-[var(--gold)]",children:["ðŸ“¨ Messages ",w>0&&(0,s.jsx)("span",{className:"text-sm bg-red-600 text-white px-2 py-0.5 rounded-full",children:w})]}),(0,s.jsx)(r.default,{onClick:()=>g(!j),children:j?"Cancel":"âœ‰ï¸ Compose"})]}),j&&(0,s.jsx)(n.default,{title:"New Message",children:(0,s.jsxs)("form",{onSubmit:N,className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold mb-1",children:"To"}),(0,s.jsxs)("select",{required:!0,className:"parchment-input w-full",value:f.toPlayerId,onChange:e=>p({...f,toPlayerId:e.target.value}),children:[(0,s.jsx)("option",{value:"",children:"Select player..."}),m.map(e=>(0,s.jsx)("option",{value:e.PlayerID,children:e.Name},e.PlayerID))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Subject"}),(0,s.jsx)("input",{className:"parchment-input w-full",value:f.subject,onChange:e=>p({...f,subject:e.target.value})})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Message"}),(0,s.jsx)("textarea",{required:!0,className:"parchment-input w-full h-24",value:f.body,onChange:e=>p({...f,body:e.target.value})})]}),(0,s.jsx)(r.default,{type:"submit",children:"Send"})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsx)("div",{className:"md:col-span-1 space-y-1",children:0===c.length?(0,s.jsx)(n.default,{children:(0,s.jsx)("p",{className:"text-[var(--ink-faded)] text-center",children:"No messages."})}):c.map(e=>(0,s.jsxs)("button",{onClick:()=>y(e),className:`w-full text-left p-3 rounded transition-colors ${b?.message_id===e.message_id?"bg-[var(--gold)]/20 border border-[var(--gold)]":"bg-[var(--wood-dark)] hover:bg-[var(--wood)]"} ${!e.read?"font-bold":""}`,children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-sm text-[var(--gold)] truncate",children:e.from_name}),(0,s.jsx)("span",{className:"text-[10px] text-[var(--ink-faded)]",children:new Date(e.created_at).toLocaleDateString()})]}),(0,s.jsx)("p",{className:"text-xs text-[var(--parchment-dark)] truncate",children:e.subject||"(no subject)"})]},e.message_id))}),(0,s.jsx)("div",{className:"md:col-span-2",children:b?(0,s.jsxs)(n.default,{title:b.subject||"(no subject)",children:[(0,s.jsxs)("div",{className:"flex justify-between text-xs text-[var(--ink-faded)] mb-3",children:[(0,s.jsxs)("span",{children:["From: ",b.from_name," â†’ ",b.to_name]}),(0,s.jsx)("span",{children:new Date(b.created_at).toLocaleString()})]}),(0,s.jsx)("p",{className:"whitespace-pre-wrap",children:b.body})]}):(0,s.jsx)(n.default,{children:(0,s.jsx)("p",{className:"text-[var(--ink-faded)] text-center",children:"Select a message to read."})})})]})]})}e.s(["default",()=>i])}]);
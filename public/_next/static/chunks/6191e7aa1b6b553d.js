(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3634,e=>{"use strict";var a=e.i(5111);function t({text:e="Loading..."}){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-end gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"}),(0,a.jsx)("div",{className:"candle-flame"}),(0,a.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"})]}),(0,a.jsx)("p",{className:"text-[var(--gold)] font-[var(--font-heading)] text-lg animate-pulse",children:e})]})}e.s(["default",()=>t])},9064,e=>{"use strict";var a=e.i(5111),t=e.i(59053);function s({children:e,className:s,pinned:n=!1,title:l}){return(0,a.jsxs)("div",{className:(0,t.cn)(n?"quest-card":"parchment","p-5 mb-4",s),children:[l&&(0,a.jsx)("h2",{className:"font-[var(--font-heading)] text-lg text-[var(--gold)] mb-3",children:l}),e]})}e.s(["default",()=>s])},54520,e=>{"use strict";var a=e.i(5111),t=e.i(59053);function s({variant:e="default",href:s,className:n,children:l,...d}){let r=(0,t.cn)("wood-btn","primary"===e&&"wood-btn-primary","secondary"===e&&"opacity-70 hover:opacity-100","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",n);return s?(0,a.jsx)("a",{href:s,className:r,children:l}):(0,a.jsx)("button",{className:r,...d,children:l})}e.s(["default",()=>s])},22841,e=>{"use strict";var a=e.i(5111),t=e.i(55703),s=e.i(4629),n=e.i(84249),l=e.i(8779),d=e.i(9064),r=e.i(54520),i=e.i(3634);function c(){return(0,a.jsx)(t.Suspense,{children:(0,a.jsx)(o,{})})}function o(){let e=(0,s.useSearchParams)(),c=e.get("campaign")||"",o=e.get("thread")||"",{isLoggedIn:h,isAdmin:u}=(0,n.useAuth)(),[m,x]=(0,t.useState)([]),[p,f]=(0,t.useState)(c),[g,j]=(0,t.useState)([]),[v,N]=(0,t.useState)(null),[b,y]=(0,t.useState)(!1),[w,k]=(0,t.useState)(""),[S,_]=(0,t.useState)(""),[T,C]=(0,t.useState)(""),[D,L]=(0,t.useState)(!0);(0,t.useEffect)(()=>{(0,l.getCampaignsList)().then(x)},[]),(0,t.useEffect)(()=>{p?(L(!0),(0,l.getDiscussions)(p).then(j).finally(()=>L(!1))):L(!1)},[p]),(0,t.useEffect)(()=>{o&&(0,l.getThread)(o).then(N)},[o]);let P=async e=>{e.preventDefault(),w&&S&&(await (0,l.createThread)(p,{title:w,content:S}),y(!1),k(""),_(""),(0,l.getDiscussions)(p).then(j))},R=async e=>{e.preventDefault(),T&&v&&(await (0,l.replyToThread)(v.thread_id,T),C(""),(0,l.getThread)(v.thread_id).then(N))};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"font-[var(--font-heading)] text-2xl text-[var(--gold)]",children:"ðŸ’¬ Discussion Boards"}),(0,a.jsxs)("select",{className:"parchment-input",value:p,onChange:e=>{f(e.target.value),N(null)},children:[(0,a.jsx)("option",{value:"",children:"Select campaign..."}),m.map(e=>(0,a.jsx)("option",{value:e.slug,children:e.name},e.campaign_id))]})]}),p?D?(0,a.jsx)(i.default,{text:"Loading..."}):(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[h&&(0,a.jsx)(r.default,{onClick:()=>y(!b),className:"w-full",children:b?"Cancel":"+ New Thread"}),b&&(0,a.jsxs)("form",{onSubmit:P,className:"space-y-2",children:[(0,a.jsx)("input",{required:!0,className:"parchment-input w-full",placeholder:"Thread title",value:w,onChange:e=>k(e.target.value)}),(0,a.jsx)("textarea",{required:!0,className:"parchment-input w-full h-20",placeholder:"First post...",value:S,onChange:e=>_(e.target.value)}),(0,a.jsx)(r.default,{type:"submit",children:"Post"})]}),0===g.length?(0,a.jsx)(d.default,{children:(0,a.jsx)("p",{className:"text-[var(--ink-faded)] text-center text-sm",children:"No discussions yet."})}):g.map(e=>(0,a.jsxs)("button",{onClick:()=>{(0,l.getThread)(e.thread_id).then(N)},className:`w-full text-left p-3 rounded transition-colors ${v?.thread_id===e.thread_id?"bg-[var(--gold)]/20 border border-[var(--gold)]":"bg-[var(--wood-dark)] hover:bg-[var(--wood)]"}`,children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[e.pinned?(0,a.jsx)("span",{title:"Pinned",children:"ðŸ“Œ"}):null,e.locked?(0,a.jsx)("span",{title:"Locked",children:"ðŸ”’"}):null,(0,a.jsx)("span",{className:"font-bold text-sm truncate",children:e.title})]}),(0,a.jsxs)("div",{className:"flex justify-between text-[10px] text-[var(--ink-faded)] mt-1",children:[(0,a.jsx)("span",{children:e.author_name}),(0,a.jsxs)("span",{children:[e.post_count," posts"]})]})]},e.thread_id))]}),(0,a.jsx)("div",{className:"md:col-span-2",children:v?(0,a.jsxs)(d.default,{title:v.title,children:[u&&(0,a.jsxs)("div",{className:"flex gap-2 mb-3",children:[(0,a.jsx)(r.default,{variant:"sm",onClick:()=>(0,l.adminThread)(v.thread_id,{pinned:!v.pinned}).then(()=>(0,l.getThread)(v.thread_id).then(N)),children:v.pinned?"Unpin":"Pin"}),(0,a.jsx)(r.default,{variant:"sm",onClick:()=>(0,l.adminThread)(v.thread_id,{locked:!v.locked}).then(()=>(0,l.getThread)(v.thread_id).then(N)),children:v.locked?"Unlock":"Lock"})]}),(0,a.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto mb-4",children:v.posts.map(e=>(0,a.jsxs)("div",{className:"p-3 bg-[var(--wood-dark)] rounded",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[e.author_photo&&(0,a.jsx)("img",{src:e.author_photo,alt:"",className:"w-6 h-6 rounded-full"}),(0,a.jsx)("span",{className:"text-sm font-bold text-[var(--gold)]",children:e.author_name}),(0,a.jsx)("span",{className:"text-[10px] text-[var(--ink-faded)]",children:new Date(e.created_at).toLocaleString()})]}),(0,a.jsx)("p",{className:"text-sm whitespace-pre-wrap",children:e.content})]},e.post_id))}),!v.locked&&h&&(0,a.jsxs)("form",{onSubmit:R,className:"flex gap-2",children:[(0,a.jsx)("textarea",{className:"parchment-input flex-1 h-16",placeholder:"Reply...",value:T,onChange:e=>C(e.target.value)}),(0,a.jsx)(r.default,{type:"submit",children:"Reply"})]})]}):(0,a.jsx)(d.default,{children:(0,a.jsx)("p",{className:"text-[var(--ink-faded)] text-center",children:"Select a thread to read."})})})]}):(0,a.jsx)(d.default,{children:(0,a.jsx)("p",{className:"text-[var(--ink-faded)] text-center",children:"Select a campaign to view discussions."})})]})}e.s(["default",()=>c])}]);
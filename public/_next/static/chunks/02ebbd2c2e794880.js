(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3634,e=>{"use strict";var a=e.i(5111);function t({text:e="Loading..."}){return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[(0,a.jsxs)("div",{className:"flex items-end gap-3",children:[(0,a.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"}),(0,a.jsx)("div",{className:"candle-flame"}),(0,a.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"})]}),(0,a.jsx)("p",{className:"text-[var(--gold)] font-[var(--font-heading)] text-lg animate-pulse",children:e})]})}e.s(["default",()=>t])},9064,e=>{"use strict";var a=e.i(5111),t=e.i(59053);function s({children:e,className:s,pinned:n=!1,title:r}){return(0,a.jsxs)("div",{className:(0,t.cn)(n?"quest-card":"parchment","p-5 mb-4",s),children:[r&&(0,a.jsx)("h2",{className:"font-[var(--font-heading)] text-lg text-[var(--gold)] mb-3",children:r}),e]})}e.s(["default",()=>s])},54520,e=>{"use strict";var a=e.i(5111),t=e.i(59053);function s({variant:e="default",href:s,className:n,children:r,...l}){let i=(0,t.cn)("wood-btn","primary"===e&&"wood-btn-primary","secondary"===e&&"opacity-70 hover:opacity-100","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",n);return s?(0,a.jsx)("a",{href:s,className:i,children:r}):(0,a.jsx)("button",{className:i,...l,children:r})}e.s(["default",()=>s])},41374,e=>{"use strict";var a=e.i(5111),t=e.i(55703),s=e.i(4629),n=e.i(84249),r=e.i(8779),l=e.i(9064),i=e.i(54520),d=e.i(3634);let c=["Recap","Attendance","Loot","Leveling","NPCs & World","Export"];function o(){return(0,a.jsx)(t.Suspense,{children:(0,a.jsx)(m,{})})}function m(){let e=(0,s.useSearchParams)().get("sessionId")||"",{isAdmin:o}=(0,n.useAuth)(),[m,x]=(0,t.useState)(0),[h,u]=(0,t.useState)(null),[p,f]=(0,t.useState)(null),[v,j]=(0,t.useState)(""),[g,b]=(0,t.useState)([]),[N,k]=(0,t.useState)(""),[y,w]=(0,t.useState)([]),[C,S]=(0,t.useState)(!1),[L,A]=(0,t.useState)("");(0,t.useEffect)(()=>{e&&((0,r.getAdminSessionDetail)(e).then(u),(0,r.getSessionPrep)(e).then(e=>{f(e),e?.previously_on&&j(e.previously_on),e?.key_npcs&&k(e.key_npcs)}))},[e]);let P=async()=>{A((await (0,r.exportSessionNotes)(e)).markdown),S(!0)};return o?h?(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("h1",{className:"font-[var(--font-heading)] text-2xl text-[var(--gold)]",children:"üìú Post-Session Recap Wizard"}),(0,a.jsxs)("p",{className:"text-sm text-[var(--parchment-dark)]",children:[h.campaign," ‚Äî ",h.title||"Untitled"," ‚Äî ",h.date]}),(0,a.jsx)("div",{className:"flex gap-1",children:c.map((e,t)=>(0,a.jsxs)("button",{onClick:()=>x(t),className:`flex-1 py-2 text-xs text-center rounded transition-colors ${t===m?"bg-[var(--gold)] text-[var(--wood-dark)] font-bold":t<m?"bg-green-900/30 text-green-400":"bg-[var(--wood-dark)] text-[var(--ink-faded)]"}`,children:[t<m?"‚úì ":"",e]},e))}),0===m&&(0,a.jsxs)(l.default,{title:"What Happened?",children:[(0,a.jsx)("p",{className:"text-xs text-[var(--ink-faded)] mb-2",children:"Write or paste your session recap. Markdown supported. Pre-populated from your prep notes if available."}),(0,a.jsx)("textarea",{className:"parchment-input w-full h-48 font-mono text-sm",value:v,onChange:e=>j(e.target.value),placeholder:"The party ventured into the Sunken Temple..."})]}),1===m&&(0,a.jsxs)(l.default,{title:"Who Was There?",children:[(0,a.jsx)("p",{className:"text-xs text-[var(--ink-faded)] mb-2",children:"Auto-filled from registrations. Adjust if needed."}),h.registrations?.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-[var(--wood-dark)] rounded mb-1",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-bold",children:e.playerName}),(0,a.jsxs)("span",{className:"text-sm text-[var(--parchment-dark)] ml-2",children:["as ",e.characterName," (Lvl ",e.characterLevel,")"]})]}),(0,a.jsx)("span",{className:e.attendanceConfirmed?"text-green-400":"text-[var(--ink-faded)]",children:e.attendanceConfirmed?"‚úì Present":"? Unknown"})]},e.registrationId))||(0,a.jsx)("p",{className:"text-[var(--ink-faded)]",children:"No registrations found."})]}),2===m&&(0,a.jsxs)(l.default,{title:"Loot Awarded",children:[(0,a.jsx)("p",{className:"text-xs text-[var(--ink-faded)] mb-2",children:"Add items the party found. These go into character inventories."}),g.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[(0,a.jsx)("input",{className:"parchment-input",placeholder:"Item name",value:e.name,onChange:e=>{let a=[...g];a[t].name=e.target.value,b(a)}}),(0,a.jsx)("select",{className:"parchment-input",value:e.rarity,onChange:e=>{let a=[...g];a[t].rarity=e.target.value,b(a)},children:["Common","Uncommon","Rare","Very Rare","Legendary"].map(e=>(0,a.jsx)("option",{children:e},e))}),(0,a.jsx)("button",{onClick:()=>b(g.filter((e,a)=>a!==t)),className:"text-red-400 text-xs",children:"Remove"})]},t)),(0,a.jsx)(i.default,{onClick:()=>b([...g,{name:"",rarity:"Common",characterId:""}]),variant:"secondary",children:"+ Add Item"})]}),3===m&&(0,a.jsxs)(l.default,{title:"XP / Milestones",children:[(0,a.jsx)("p",{className:"text-xs text-[var(--ink-faded)] mb-2",children:"Level up characters as needed. Click to bump their level."}),h.registrations?.map(e=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-[var(--wood-dark)] rounded mb-1",children:[(0,a.jsxs)("span",{children:[e.characterName," ‚Äî Level ",e.characterLevel]}),(0,a.jsx)(i.default,{variant:"sm",onClick:()=>{},children:"Level Up"})]},e.registrationId))]}),4===m&&(0,a.jsxs)(l.default,{title:"Key NPCs & World State",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Key NPCs Encountered"}),(0,a.jsx)("textarea",{className:"parchment-input w-full h-20",value:N,onChange:e=>k(e.target.value),placeholder:"One per line: Gundren Rockseeker, Sildar Hallwinter..."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-bold mb-2",children:"World State Changes"}),y.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 mb-2",children:[(0,a.jsx)("input",{className:"parchment-input",placeholder:"Fact (e.g. 'King's Status')",value:e.fact,onChange:e=>{let a=[...y];a[t].fact=e.target.value,w(a)}}),(0,a.jsx)("input",{className:"parchment-input",placeholder:"Value (e.g. 'Dead')",value:e.value,onChange:e=>{let a=[...y];a[t].value=e.target.value,w(a)}})]},t)),(0,a.jsx)(i.default,{onClick:()=>w([...y,{fact:"",value:""}]),variant:"secondary",children:"+ Add Fact"})]})]}),5===m&&(0,a.jsx)(l.default,{title:"Export to Obsidian",children:C?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"text-green-400",children:"‚úì Export generated"}),(0,a.jsx)(i.default,{onClick:()=>{let e=new Blob([L],{type:"text/markdown"}),a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=`${h?.campaign}-${h?.date}.md`,t.click(),URL.revokeObjectURL(a)},variant:"sm",children:"Download .md"})]}),(0,a.jsx)("pre",{className:"parchment-input w-full h-64 overflow-auto text-xs font-mono whitespace-pre-wrap",children:L})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("p",{className:"text-[var(--parchment-dark)] mb-4",children:"Generate a markdown file with YAML frontmatter ready for your Obsidian vault."}),(0,a.jsx)(i.default,{onClick:P,children:"Generate Obsidian Export"})]})}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)(i.default,{onClick:()=>x(Math.max(0,m-1)),variant:"secondary",disabled:0===m,children:"‚Üê Previous"}),m<c.length-1?(0,a.jsx)(i.default,{onClick:()=>x(m+1),children:"Next ‚Üí"}):(0,a.jsx)(i.default,{onClick:()=>window.location.href="/admin/sessions",children:"Finish"})]})]}):(0,a.jsx)(d.default,{text:"Loading session..."}):(0,a.jsx)(l.default,{title:"Access Denied",children:(0,a.jsx)("p",{children:"Admin only."})})}e.s(["default",()=>o])}]);
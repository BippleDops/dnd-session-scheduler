(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3634,e=>{"use strict";var s=e.i(5111);function a({text:e="Loading..."}){return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[(0,s.jsxs)("div",{className:"flex items-end gap-3",children:[(0,s.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"}),(0,s.jsx)("div",{className:"candle-flame"}),(0,s.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"})]}),(0,s.jsx)("p",{className:"text-[var(--gold)] font-[var(--font-heading)] text-lg animate-pulse",children:e})]})}e.s(["default",()=>a])},9064,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({children:e,className:t,pinned:l=!1,title:n}){return(0,s.jsxs)("div",{className:(0,a.cn)(l?"quest-card":"parchment","p-5 mb-4",t),children:[n&&(0,s.jsx)("h2",{className:"font-[var(--font-heading)] text-lg text-[var(--gold)] mb-3",children:n}),e]})}e.s(["default",()=>t])},54520,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({variant:e="default",href:t,className:l,children:n,...r}){let i=(0,a.cn)("wood-btn","primary"===e&&"wood-btn-primary","secondary"===e&&"opacity-70 hover:opacity-100","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",l);return t?(0,s.jsx)("a",{href:t,className:i,children:n}):(0,s.jsx)("button",{className:i,...r,children:n})}e.s(["default",()=>t])},85565,e=>{"use strict";var s=e.i(5111),a=e.i(55703),t=e.i(4629),l=e.i(84249),n=e.i(8779),r=e.i(9064),i=e.i(54520),c=e.i(3634);function o(){return(0,s.jsx)(a.Suspense,{children:(0,s.jsx)(d,{})})}function d(){let e=(0,t.useSearchParams)().get("sessionId")||"",{isAdmin:o}=(0,l.useAuth)(),[d,u]=(0,a.useState)(null),[h,p]=(0,a.useState)(null),[m,x]=(0,a.useState)(null),[f,v]=(0,a.useState)(!1),[g,y]=(0,a.useState)(!1);(0,a.useEffect)(()=>{e&&((0,n.getAdminSessionDetail)(e).then(u),(0,n.getSessionPrep)(e).then(p),(0,n.getSessionChecklist)(e).then(x))},[e]);let j=async()=>{h&&(v(!0),await (0,n.saveSessionPrep)(e,{previouslyOn:h.previously_on,keyNpcs:h.key_npcs,scenesPlanned:h.scenes_planned,secrets:h.secrets,possibleLoot:h.possible_loot,dmTeaser:h.dm_teaser,foundryScene:h.foundry_scene,mapScreenshotUrl:h.map_screenshot_url}),v(!1),y(!0),setTimeout(()=>y(!1),2e3))},b=async s=>{if(!m)return;let a={...m,[s]:+!m[s]};x(a),await (0,n.saveSessionChecklist)(e,a)};if(!o)return(0,s.jsx)(r.default,{title:"Access Denied",children:(0,s.jsx)("p",{children:"Admin only."})});if(!d||!h)return(0,s.jsx)(c.default,{text:"Loading prep..."});let _=[{key:"recap_written",label:"Previous session recap written",icon:"ðŸ“"},{key:"attendance_confirmed",label:"All players confirmed attendance",icon:"âœ…"},{key:"characters_leveled",label:"Characters leveled up correctly",icon:"â¬†ï¸"},{key:"foundry_loaded",label:"Foundry scenes loaded",icon:"ðŸŽ®"},{key:"prep_reviewed",label:"Prep notes reviewed",icon:"ðŸ“‹"},{key:"loot_prepared",label:"Loot table prepared",icon:"ðŸ’°"},{key:"music_set",label:"Music/ambiance set",icon:"ðŸŽµ"}],N=m?_.filter(e=>m[e.key]).length:0;return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"font-[var(--font-heading)] text-2xl text-[var(--gold)]",children:["ðŸ—ºï¸ DM Prep â€” ",d.title||d.campaign]}),(0,s.jsxs)("p",{className:"text-sm text-[var(--parchment-dark)]",children:[d.date," at ",d.startTime]})]}),(0,s.jsx)(i.default,{onClick:j,disabled:f,children:f?"Saving...":g?"âœ“ Saved":"Save Prep Notes"})]}),(0,s.jsxs)(r.default,{title:`Pre-Flight Checklist (${N}/${_.length})`,children:[(0,s.jsx)("div",{className:"h-2 bg-[var(--wood-dark)] rounded overflow-hidden mb-3",children:(0,s.jsx)("div",{className:"h-full bg-[var(--gold)] transition-all",style:{width:`${N/_.length*100}%`}})}),(0,s.jsx)("div",{className:"space-y-1",children:_.map(e=>(0,s.jsxs)("button",{onClick:()=>b(e.key),className:`w-full text-left flex items-center gap-2 p-2 rounded transition-colors ${m?.[e.key]?"bg-green-900/20 text-green-400":"bg-[var(--wood-dark)] text-[var(--parchment-dark)]"}`,children:[(0,s.jsx)("span",{children:m?.[e.key]?"âœ…":"â¬œ"}),(0,s.jsxs)("span",{children:[e.icon," ",e.label]})]},e.key))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsx)(r.default,{title:"Previously On...",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-32",value:h.previously_on||"",onChange:e=>p({...h,previously_on:e.target.value}),placeholder:"Last session, the party..."})}),(0,s.jsx)(r.default,{title:"DM Teaser (sent to players)",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-32",value:h.dm_teaser||"",onChange:e=>p({...h,dm_teaser:e.target.value}),placeholder:"A mysterious fog rolls into town..."})}),(0,s.jsx)(r.default,{title:"Key NPCs This Session",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-24",value:h.key_npcs||"",onChange:e=>p({...h,key_npcs:e.target.value}),placeholder:"One per line..."})}),(0,s.jsx)(r.default,{title:"Scenes Planned",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-24",value:h.scenes_planned||"",onChange:e=>p({...h,scenes_planned:e.target.value}),placeholder:"1. Tavern encounter\\n2. Travel to the ruins\\n3. Boss fight"})}),(0,s.jsx)(r.default,{title:"Secrets & Clues",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-24",value:h.secrets||"",onChange:e=>p({...h,secrets:e.target.value}),placeholder:"The barkeep is actually a dragon in disguise..."})}),(0,s.jsx)(r.default,{title:"Possible Loot",children:(0,s.jsx)("textarea",{className:"parchment-input w-full h-24",value:h.possible_loot||"",onChange:e=>p({...h,possible_loot:e.target.value}),placeholder:"Sword of Dragonslaying, 500gp, Scroll of Fireball"})}),(0,s.jsx)(r.default,{title:"Foundry Scene",children:(0,s.jsx)("input",{className:"parchment-input w-full",value:h.foundry_scene||"",onChange:e=>p({...h,foundry_scene:e.target.value}),placeholder:"Scene name in Foundry VTT"})}),(0,s.jsxs)(r.default,{title:"Map Screenshot URL",children:[(0,s.jsx)("input",{className:"parchment-input w-full",value:h.map_screenshot_url||"",onChange:e=>p({...h,map_screenshot_url:e.target.value}),placeholder:"https://..."}),h.map_screenshot_url&&(0,s.jsx)("img",{src:h.map_screenshot_url,alt:"Map",className:"mt-2 rounded max-h-40 object-cover"})]})]})]})}e.s(["default",()=>o])}]);
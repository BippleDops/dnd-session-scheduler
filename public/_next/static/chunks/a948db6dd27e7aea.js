(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,3634,e=>{"use strict";var t=e.i(5111);function l({text:e="Loading..."}){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-end gap-3",children:[(0,t.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"}),(0,t.jsx)("div",{className:"candle-flame"}),(0,t.jsx)("div",{className:"w-2 h-8 bg-[var(--parchment-dark)] rounded-t-sm"})]}),(0,t.jsx)("p",{className:"text-[var(--gold)] font-[var(--font-heading)] text-lg animate-pulse",children:e})]})}e.s(["default",()=>l])},9064,e=>{"use strict";var t=e.i(5111),l=e.i(59053);function a({children:e,className:a,pinned:s=!1,title:n}){return(0,t.jsxs)("div",{className:(0,l.cn)(s?"quest-card":"parchment","p-5 mb-4",a),children:[n&&(0,t.jsx)("h2",{className:"font-[var(--font-heading)] text-lg text-[var(--gold)] mb-3",children:n}),e]})}e.s(["default",()=>a])},54520,e=>{"use strict";var t=e.i(5111),l=e.i(59053);function a({variant:e="default",href:a,className:s,children:n,...i}){let d=(0,l.cn)("wood-btn","primary"===e&&"wood-btn-primary","secondary"===e&&"opacity-70 hover:opacity-100","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",s);return a?(0,t.jsx)("a",{href:a,className:d,children:n}):(0,t.jsx)("button",{className:d,...i,children:n})}e.s(["default",()=>a])},58633,e=>{"use strict";var t=e.i(5111),l=e.i(55703),a=e.i(4629),s=e.i(84249),n=e.i(8779),i=e.i(9064),d=e.i(54520),r=e.i(3634);function c(){return(0,t.jsx)(l.Suspense,{children:(0,t.jsx)(o,{})})}function o(){let e=(0,a.useSearchParams)().get("poll")||"",{isLoggedIn:c,isAdmin:o}=(0,s.useAuth)(),[m,x]=(0,l.useState)([]),[p,u]=(0,l.useState)(null),[h,v]=(0,l.useState)([]),[f,g]=(0,l.useState)(!1),[j,b]=(0,l.useState)({campaignId:"",title:"",options:""}),[N,y]=(0,l.useState)([]),[w,k]=(0,l.useState)(!0);(0,l.useEffect)(()=>{Promise.all([(0,n.getPolls)(),(0,n.getCampaignsList)()]).then(([e,t])=>{x(e),v(t)}).finally(()=>k(!1))},[]),(0,l.useEffect)(()=>{e&&(0,n.getPollDetail)(e).then(u)},[e]);let S=async e=>{e.preventDefault();let t=j.options.split("\n").map(e=>e.trim()).filter(Boolean);await (0,n.createPoll)({campaignId:j.campaignId||void 0,title:j.title,options:t}),g(!1),(0,n.getPolls)().then(x)},P=async()=>{p&&(await (0,n.votePoll)(p.poll_id,N),(0,n.getPollDetail)(p.poll_id).then(u))};if(w)return(0,t.jsx)(r.default,{text:"Loading polls..."});let C=e=>p?p.votes.filter(t=>t.selected_options.includes(e)).length:0,_=p?Math.max(...(p.options||[]).map(C),1):1;return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsx)("h1",{className:"font-[var(--font-heading)] text-2xl text-[var(--gold)]",children:"ðŸ“… Availability Polls"}),o&&(0,t.jsx)(d.default,{onClick:()=>g(!f),children:f?"Cancel":"+ New Poll"})]}),f&&(0,t.jsx)(i.default,{title:"Create Poll",children:(0,t.jsxs)("form",{onSubmit:S,className:"space-y-3",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Title *"}),(0,t.jsx)("input",{required:!0,className:"parchment-input w-full",value:j.title,onChange:e=>b({...j,title:e.target.value}),placeholder:"When can you play next?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Campaign"}),(0,t.jsxs)("select",{className:"parchment-input w-full",value:j.campaignId,onChange:e=>b({...j,campaignId:e.target.value}),children:[(0,t.jsx)("option",{value:"",children:"All campaigns"}),h.map(e=>(0,t.jsx)("option",{value:e.campaign_id,children:e.name},e.campaign_id))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-xs font-bold mb-1",children:"Options (one per line) *"}),(0,t.jsx)("textarea",{required:!0,className:"parchment-input w-full h-24",value:j.options,onChange:e=>b({...j,options:e.target.value}),placeholder:"Saturday Feb 15, 6pm Sunday Feb 16, 2pm Saturday Feb 22, 6pm"})]}),(0,t.jsx)(d.default,{type:"submit",children:"Create Poll"})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,t.jsx)("div",{className:"space-y-2",children:0===m.length?(0,t.jsx)(i.default,{children:(0,t.jsx)("p",{className:"text-[var(--ink-faded)] text-center text-sm",children:"No polls yet."})}):m.map(e=>(0,t.jsxs)("button",{onClick:()=>{(0,n.getPollDetail)(e.poll_id).then(u),y([])},className:`w-full text-left p-3 rounded transition-colors ${p?.poll_id===e.poll_id?"bg-[var(--gold)]/20 border border-[var(--gold)]":"bg-[var(--wood-dark)] hover:bg-[var(--wood)]"}`,children:[(0,t.jsx)("span",{className:"font-bold text-sm",children:e.title}),(0,t.jsxs)("div",{className:"flex justify-between text-[10px] text-[var(--ink-faded)] mt-1",children:[(0,t.jsx)("span",{children:e.campaign_name||"All"}),(0,t.jsx)("span",{className:"Open"===e.status?"text-green-400":"text-[var(--ink-faded)]",children:e.status})]})]},e.poll_id))}),(0,t.jsx)("div",{className:"md:col-span-2",children:p?(0,t.jsxs)(i.default,{title:p.title,children:[(0,t.jsxs)("p",{className:"text-sm text-[var(--parchment-dark)] mb-4",children:[p.votes.length," responses"]}),(0,t.jsx)("div",{className:"space-y-2 mb-4",children:(p.options||[]).map(e=>{let l=C(e),a=l/_*100;return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,t.jsxs)("button",{onClick:()=>c&&void y(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e]),className:`flex items-center gap-2 ${N.includes(e)?"text-[var(--gold)] font-bold":""}`,children:[c&&(0,t.jsx)("span",{children:N.includes(e)?"âœ…":"â¬œ"}),(0,t.jsx)("span",{children:e})]}),(0,t.jsxs)("span",{className:"text-[var(--gold)]",children:[l," votes"]})]}),(0,t.jsx)("div",{className:"h-3 bg-[var(--wood-dark)] rounded overflow-hidden",children:(0,t.jsx)("div",{className:"h-full bg-green-600 transition-all rounded",style:{width:`${a}%`,opacity:.4+a/100*.6}})}),(0,t.jsx)("div",{className:"text-[10px] text-[var(--ink-faded)] mt-0.5",children:p.votes.filter(t=>t.selected_options.includes(e)).map(e=>e.player_name).join(", ")||"No votes"})]},e)})}),c&&"Open"===p.status&&(0,t.jsx)(d.default,{onClick:P,disabled:0===N.length,children:"Submit Vote"})]}):(0,t.jsx)(i.default,{children:(0,t.jsx)("p",{className:"text-[var(--ink-faded)] text-center",children:"Select a poll to view."})})})]})]})}e.s(["default",()=>c])}]);
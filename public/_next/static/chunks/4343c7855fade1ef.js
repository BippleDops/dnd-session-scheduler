(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,49159,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({campaign:e,size:t=36}){let l=(0,a.campaignColor)(e),i=e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,s.jsx)("span",{className:"wax-seal",style:{backgroundColor:l,width:t,height:t,fontSize:.3*t},title:e,children:i})}e.s(["default",()=>t])},31119,e=>{"use strict";var s=e.i(55703);function a(e,t=[]){let[l,i]=(0,s.useState)(null),[n,r]=(0,s.useState)(!0),[c,d]=(0,s.useState)(null),o=(0,s.useCallback)(()=>{r(!0),d(null),e().then(i).catch(e=>d(e.message||"Failed to load")).finally(()=>r(!1))},t);return(0,s.useEffect)(()=>{o()},[o]),{data:l,loading:n,error:c,refetch:o}}e.s(["useApi",()=>a])},54520,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({variant:e="default",href:t,className:l,children:i,...n}){let r=(0,a.cn)("wood-btn","primary"===e&&"wood-btn-primary","danger"===e&&"wood-btn-danger","sm"===e&&"text-sm py-1 px-3",l);return t?(0,s.jsx)("a",{href:t,className:r,children:i}):(0,s.jsx)("button",{className:r,...n,children:i})}e.s(["default",()=>t])},9064,e=>{"use strict";var s=e.i(5111),a=e.i(59053);function t({children:e,className:t,pinned:l=!1}){return(0,s.jsx)("div",{className:(0,a.cn)(l?"quest-card":"parchment","p-5 mb-4",t),children:e})}e.s(["default",()=>t])},51070,e=>{"use strict";var s=e.i(5111),a=e.i(55703),t=e.i(4629),l=e.i(31119),i=e.i(8779),n=e.i(59053),r=e.i(9064),c=e.i(49159),d=e.i(54520),o=e.i(55657);function x(){return(0,s.jsx)(a.Suspense,{children:(0,s.jsx)(m,{})})}function m(){let e=(0,t.useSearchParams)(),x=e.get("action"),m=e.get("sessionId"),{toast:h}=(0,o.useToast)(),{data:u}=(0,l.useApi)(i.getCampaigns),[j,p]=(0,a.useState)("create"===x?"create":m?"detail":"list"),[v,g]=(0,a.useState)(m||""),[b,N]=(0,a.useState)(""),[f,C]=(0,a.useState)(""),k={};b&&(k.status=b),f&&(k.campaign=f);let{data:S,refetch:y}=(0,l.useApi)(()=>(0,i.getAdminSessions)(Object.keys(k).length?k:void 0),[b,f]),{data:w,refetch:T}=(0,l.useApi)(()=>v?(0,i.getAdminSessionDetail)(v):Promise.resolve(null),[v]),[A,D]=(0,a.useState)(""),[P,I]=(0,a.useState)(""),[L,M]=(0,a.useState)(""),[F,U]=(0,a.useState)(""),[q,O]=(0,a.useState)(""),[R,W]=(0,a.useState)("6"),[$,z]=(0,a.useState)("4"),[B,E]=(0,a.useState)(""),[H,K]=(0,a.useState)("any"),[J,V]=(0,a.useState)(""),[G,Q]=(0,a.useState)(""),X=A?[0,6].includes(new Date(A+"T12:00:00").getDay())?"Weekend":"Weeknight":"",Y=async e=>{if(e.preventDefault(),!confirm(`Create ${L} session on ${A}?`))return;let s=await (0,i.createAdminSession)({date:A,startTime:P,campaign:L,title:F,description:q,maxPlayers:parseInt(R),duration:parseInt($),difficulty:B,levelTier:H,location:J,dmNotes:G});s.success?(h("Session created!","success"),g(s.sessionId||""),p("detail")):h(JSON.stringify(s.errors||s.message),"error")},Z=e=>{g(e),p("detail")};return(0,s.jsxs)("div",{children:["list"===j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"scroll-heading text-3xl",children:"âš”ï¸ Session Management"}),(0,s.jsx)(d.default,{variant:"primary",onClick:()=>p("create"),children:"+ Create Session"})]}),(0,s.jsxs)("div",{className:"flex gap-3 mb-4 flex-wrap",children:[(0,s.jsxs)("select",{value:b,onChange:e=>N(e.target.value),className:"tavern-input max-w-[160px]",children:[(0,s.jsx)("option",{value:"",children:"All Statuses"}),(0,s.jsx)("option",{value:"Scheduled",children:"Scheduled"}),(0,s.jsx)("option",{value:"Completed",children:"Completed"}),(0,s.jsx)("option",{value:"Cancelled",children:"Cancelled"})]}),(0,s.jsxs)("select",{value:f,onChange:e=>C(e.target.value),className:"tavern-input max-w-[160px]",children:[(0,s.jsx)("option",{value:"",children:"All Campaigns"}),(u||[]).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsx)("div",{className:"parchment overflow-x-auto",children:(0,s.jsxs)("table",{className:"w-full text-sm text-[var(--ink)]",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b-2 border-[var(--parchment-dark)]",children:[(0,s.jsx)("th",{className:"text-left p-2",children:"Date"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Time"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Campaign"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Title"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Players"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Status"}),(0,s.jsx)("th",{className:"p-2"})]})}),(0,s.jsx)("tbody",{children:(S||[]).map(e=>(0,s.jsxs)("tr",{className:"border-b border-[rgba(0,0,0,0.05)] cursor-pointer hover:bg-[rgba(201,169,89,0.05)]",onClick:()=>Z(e.sessionId),children:[(0,s.jsx)("td",{className:"p-2",children:(0,n.formatDate)(e.date)}),(0,s.jsx)("td",{className:"p-2",children:(0,n.formatTime)(e.startTime)}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsx)(c.default,{campaign:e.campaign,size:24})}),(0,s.jsx)("td",{className:"p-2",children:e.title}),(0,s.jsxs)("td",{className:"p-2",children:[e.registeredCount,"/",e.maxPlayers]}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsx)("span",{className:"tier-shield",children:e.status})}),(0,s.jsx)("td",{className:"p-2",children:(0,s.jsx)(d.default,{variant:"sm",onClick:s=>{s.stopPropagation(),Z(e.sessionId)},children:"View"})})]},e.sessionId))})]})})]}),"create"===j&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:"scroll-heading text-3xl mb-6",children:"ðŸ“ Create Session"}),(0,s.jsx)("form",{onSubmit:Y,children:(0,s.jsxs)(r.default,{className:"max-w-xl space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Date *"}),(0,s.jsx)("input",{type:"date",value:A,onChange:e=>D(e.target.value),className:"tavern-input",required:!0}),X&&(0,s.jsx)("span",{className:"text-xs text-[var(--ink-faded)]",children:X})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Start Time *"}),(0,s.jsxs)("select",{value:P,onChange:e=>I(e.target.value),className:"tavern-input",required:!0,children:[(0,s.jsx)("option",{value:"",children:"â€” Select date first â€”"}),"Weekend"===X?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("option",{value:"12:00",children:"12:00 PM"}),(0,s.jsx)("option",{value:"17:00",children:"5:00 PM"})]}):"Weeknight"===X?(0,s.jsx)("option",{value:"18:00",children:"6:00 PM"}):null]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Campaign *"}),(0,s.jsxs)("select",{value:L,onChange:e=>M(e.target.value),className:"tavern-input",required:!0,children:[(0,s.jsx)("option",{value:"",children:"â€” Select â€”"}),(u||[]).map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Title"}),(0,s.jsx)("input",{value:F,onChange:e=>U(e.target.value),className:"tavern-input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Description"}),(0,s.jsx)("textarea",{value:q,onChange:e=>O(e.target.value),className:"tavern-input",rows:3})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Max Players"}),(0,s.jsx)("input",{type:"number",value:R,onChange:e=>W(e.target.value),className:"tavern-input",min:1,max:20})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Duration (hrs)"}),(0,s.jsx)("input",{type:"number",value:$,onChange:e=>z(e.target.value),className:"tavern-input",min:1,max:12})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Difficulty"}),(0,s.jsxs)("select",{value:B,onChange:e=>E(e.target.value),className:"tavern-input",children:[(0,s.jsx)("option",{value:"",children:"â€”"}),(0,s.jsx)("option",{value:"Easy",children:"Easy"}),(0,s.jsx)("option",{value:"Medium",children:"Medium"}),(0,s.jsx)("option",{value:"Hard",children:"Hard"}),(0,s.jsx)("option",{value:"Deadly",children:"Deadly"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Level Tier"}),(0,s.jsxs)("select",{value:H,onChange:e=>K(e.target.value),className:"tavern-input",children:[(0,s.jsx)("option",{value:"any",children:"Any Level (1-20)"}),(0,s.jsx)("option",{value:"tier1",children:"Tier 1: Lv 1-4"}),(0,s.jsx)("option",{value:"tier2",children:"Tier 2: Lv 5-10"}),(0,s.jsx)("option",{value:"tier3",children:"Tier 3: Lv 11-16"}),(0,s.jsx)("option",{value:"tier4",children:"Tier 4: Lv 17-20"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"Location"}),(0,s.jsx)("input",{value:J,onChange:e=>V(e.target.value),className:"tavern-input"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-semibold text-[var(--ink)] mb-1",children:"DM Notes"}),(0,s.jsx)("textarea",{value:G,onChange:e=>Q(e.target.value),className:"tavern-input",rows:3})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(d.default,{variant:"primary",type:"submit",children:"Create Session"}),(0,s.jsx)(d.default,{onClick:()=>p("list"),children:"Cancel"})]})]})})]}),"detail"===j&&w&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h1",{className:"scroll-heading text-3xl",children:w.title||w.campaign}),(0,s.jsx)(d.default,{onClick:()=>{p("list"),y()},children:"â† Back"})]}),(0,s.jsx)(r.default,{children:(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-[var(--ink)]",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Date:"})," ",(0,n.formatDate)(w.date)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Time:"})," ",(0,n.formatTime)(w.startTime)," â€” ",(0,n.formatTime)(w.endTime)]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Campaign:"})," ",(0,s.jsx)(c.default,{campaign:w.campaign,size:20})," ",w.campaign]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Status:"})," ",(0,s.jsx)("span",{className:"tier-shield",children:w.status})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("strong",{children:"Players:"})," ",w.registeredCount," / ",w.maxPlayers]}),w.dmNotes&&(0,s.jsxs)("div",{className:"col-span-2",children:[(0,s.jsx)("strong",{children:"DM Notes:"})," ",w.dmNotes]})]})}),(0,s.jsx)("h2",{className:"scroll-heading text-xl mb-3",children:"Registrations"}),(0,s.jsx)("div",{className:"parchment overflow-x-auto mb-4",children:(0,s.jsxs)("table",{className:"w-full text-sm text-[var(--ink)]",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b-2 border-[var(--parchment-dark)]",children:[(0,s.jsx)("th",{className:"text-left p-2",children:"Player"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Character"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Class"}),(0,s.jsx)("th",{className:"p-2",children:"Lv"}),(0,s.jsx)("th",{className:"text-left p-2",children:"Status"}),(0,s.jsx)("th",{className:"p-2",children:"Attended"}),(0,s.jsx)("th",{className:"p-2"})]})}),(0,s.jsx)("tbody",{children:(w.registrations||[]).map(e=>(0,s.jsxs)("tr",{className:"border-b border-[rgba(0,0,0,0.05)]",children:[(0,s.jsx)("td",{className:"p-2",children:e.playerName}),(0,s.jsx)("td",{className:"p-2 font-semibold",children:e.characterName}),(0,s.jsx)("td",{className:"p-2",children:e.characterClass}),(0,s.jsx)("td",{className:"p-2 text-center",children:e.characterLevel}),(0,s.jsx)("td",{className:"p-2",children:e.status}),(0,s.jsx)("td",{className:"p-2 text-center",children:(0,s.jsx)("input",{type:"checkbox",checked:e.attendanceConfirmed,onChange:s=>{(0,i.markAttendance)(e.registrationId,s.target.checked),h("Updated","success")},className:"accent-[var(--gold)]"})}),(0,s.jsx)("td",{className:"p-2",children:"Confirmed"===e.status&&(0,s.jsx)(d.default,{variant:"sm",onClick:async()=>{await (0,i.cancelAdminRegistration)(e.registrationId),h("Cancelled","success"),T()},children:"Cancel"})})]},e.registrationId))})]})}),(0,s.jsxs)("div",{className:"flex gap-3 flex-wrap",children:["Scheduled"===w.status&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(d.default,{variant:"danger",onClick:async()=>{confirm("Cancel session?")&&(await (0,i.cancelAdminSession)(w.sessionId),h("Cancelled","success"),p("list"),y())},children:"Cancel Session"}),(0,s.jsx)(d.default,{variant:"primary",onClick:async()=>{confirm("Mark completed?")&&(await (0,i.completeAdminSession)(w.sessionId),h("Completed!","success"),T())},children:"Mark Completed"})]}),(0,s.jsx)(d.default,{onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/signup?sessionId=${w.sessionId}`),h("Link copied!","success")},children:"Copy Sign-Up Link"})]})]})]})}e.s(["default",()=>x])}]);